<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ETHERLEGIONS</title>
  <link rel="stylesheet" href="style.css">

  <!-- Ethers.js -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.8.0/dist/ethers.umd.min.js"></script>
  <!-- WalletConnect Provider -->
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <!-- Coinbase Wallet SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@coinbase/wallet-sdk@4.1.0/dist/umd/index.min.js"></script>
  <!-- Web3Modal -->
  <script src="https://unpkg.com/web3modal@1.9.12/dist/index.js"></script>
  <!-- Google reCAPTCHA -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>

  <style>
    /* NFT grid styles */
    .nft-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
    }
    .nft-card {
      border: 1px solid #ccc;
      border-radius: 12px;
      overflow: hidden;
      width: 180px;
      text-align: center;
      background-color: #f8f8f8;
      transition: transform 0.2s;
      padding: 10px;
    }
    .nft-card:hover {
      transform: scale(1.05);
      box-shadow: 0px 5px 15px rgba(0,0,0,0.3);
    }
    .nft-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 8px;
    }
    .nft-card button {
      margin-top: 8px;
      padding: 5px 10px;
      border: none;
      border-radius: 6px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
    }
    .nft-card button:hover {
      background-color: #45a049;
    }

    /* Whitelist display list */
    #whitelistList {
      max-height: 200px;
      overflow-y: auto;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 10px;
      background-color: #f0f0f0;
      font-size: 14px;
      list-style: none;
    }
    #whitelistList li {
      padding: 4px 0;
      border-bottom: 1px solid #ddd;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- HEADER -->
    <header>
      <h1>ETHERLEGIONS</h1>
      <button id="connectWallet">Connect Wallet</button>
    </header>

    <!-- BANNER -->
    <section class="banner">
      <img src="https://apricot-working-dog-205.mypinata.cloud/ipfs/bafkreidzmmn5fxyjmw4bdgfggdxpit7ntydejolzom2sc6bmlyniqjlija" alt="Banner">
    </section>

    <!-- STATS -->
    <section class="stats">
      <p>Total NFTs: <span id="totalSupply">0</span></p>
      <p>Minted: <span id="minted">0</span></p>
      <p>Remaining: <span id="remaining">0</span></p>
    </section>

    <!-- MINT SECTION -->
    <section class="mint">
      <h2>Mint Your NFT</h2>
      <div class="mint-box">
        <input type="number" id="mintAmount" placeholder="Number of NFTs" min="1">
        <div class="g-recaptcha" data-sitekey="6Lc7GPUrAAAAAGVFjI219WeeX7g4HxbIrFKvjiDw"></div>
        <button id="mintBtn">Mint Now</button>
      </div>
      <p class="price-info">
        Platform Fee: <strong>$3.00</strong><br>
        Total: <span id="totalPrice">0.000000</span> ETH (~$<span id="usdPrice">0.00</span>)
      </p>
    </section>

    <!-- USER'S MINTED NFT GRID -->
    <section class="user-nft-section">
      <h2>Your Minted NFTs</h2>
      <div id="userNftGrid" class="nft-grid">
        <!-- User NFTs will be appended here dynamically -->
      </div>
    </section>

    <!-- ADMIN PANEL -->
    <section class="admin" id="adminPanel" style="display:none;">
      <h2>Admin Panel</h2>
      <div class="admin-section">
        <h3>Mint Control</h3>
        <div class="admin-controls">
          <button id="pauseBtn" class="admin-btn">Pause Mint</button>
          <button id="resumeBtn" class="admin-btn">Resume Mint</button>
        </div>
      </div>

      <hr>

      <div class="admin-section">
        <h3>Whitelist Sale</h3>
        <div class="admin-controls">
          <button id="startWhitelistBtn" class="admin-btn">Start Whitelist Sale</button>
          <button id="stopWhitelistBtn" class="admin-btn">Stop Whitelist Sale</button>
        </div>
      </div>

      <hr>

      <div class="admin-section">
        <h3>Public Sale</h3>
        <div class="admin-controls">
          <button id="startPublicBtn" class="admin-btn">Start Public Sale</button>
          <button id="stopPublicBtn" class="admin-btn">Stop Public Sale</button>
        </div>
      </div>

      <p id="adminMessage" class="admin-message"></p>
    </section>

    <!-- WHITELIST + WITHDRAW -->
    <section class="panel-section" id="whitelistPanel" style="flex:1; display:none;">
      <h2>Whitelist Management</h2>
      <div class="panel-card">
        <input type="text" id="whitelistAddress" placeholder="Enter addresses (comma separated)">
        <div class="button-group">
          <button id="addWhitelistBtn" class="admin-btn">Add to Whitelist</button>
          <button id="removeWhitelistBtn" class="admin-btn">Remove from Whitelist</button>
          <button id="addAllWhitelistBtn" class="admin-btn">Auto Upload Whitelist</button>
        </div>
        <p id="autoWhitelistProgress" style="margin-top:10px; font-weight:600;"></p>
      </div>
    </section>

    <section class="panel-section" id="withdrawPanel" style="flex:1; display:none;">
      <h2>Withdraw Funds</h2>
      <div class="panel-card">
        <p><strong>Collected Fees:</strong> <span id="feesCollected">0.000000</span> ETH</p>
        <button id="withdrawBtn" class="admin-btn">Withdraw Platform Fees</button>
      </div>
    </section>

    <!-- SALE STATUS -->
    <section class="panel-section full-width">
      <h2>Sale Status</h2>
      <div class="panel-card">
        <p><strong>Sale Status:</strong> <span id="saleStatus">Inactive âšª</span></p>
      </div>
    </section>

    <!-- WHITELIST CHECKER + DISPLAY --> 
<section class="whitelist-display" id="whitelistDisplaySection" style="margin-top:30px;">
  <h2>Check Whitelist Status</h2>
  <div class="whitelist-search-container" style="margin-bottom:15px;">
    <input type="text" id="whitelistSearch" placeholder="Enter wallet address" style="padding:5px; width:250px;">
    <button id="whitelistSearchBtn" style="padding:5px 10px; margin-left:5px;">Check</button>
  </div>
  <p id="whitelistResult" style="font-weight:600; margin-top:10px;"></p>

  <h3>All Whitelisted Addresses</h3>
  <ul id="whitelistList" style="max-height:300px; overflow-y:auto; padding-left:20px; border:1px solid #ccc; border-radius:6px; background:#f9f9f9; margin-top:10px;">
    <li>Loading whitelist...</li>
  </ul>
</section>

<div id="message"></div>


  <!-- CONFIG VARIABLES -->
  <script>
    const INFURA_ID = "a70fd3de0ceb40ff848b3a20bc1df402";
    const PLATFORM_WALLET = "0xa082e12865d934f77de1a44a72413bd4bbb51adb".toLowerCase();
    const NETWORKS = {
      84531: { name: "Base Sepolia Testnet", chainId: 84531, rpc: `https://sepolia.base.org` },
      8453: { name: "Base Mainnet", chainId: 8453, rpc: `https://mainnet.base.org` }
    };
    const TARGET_CHAIN_ID = 8453; // Base Mainnet
  </script>

  <!-- PRELOAD WHITELIST ARRAY -->
  <script src="allWhitelistAddresses.js"></script>

  <!-- MAIN SCRIPT -->
  <script src="main.js" defer></script>

</body>
</html>

